<!DOCTYPE html>
<html lang="sk">
<head>
  <!-- Preload Critical Resources -->
  <link rel="preload" href="https://cdn.tailwindcss.com" as="script">
  <link rel="dns-prefetch" href="https://fonts.googleapis.com">
  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
  <link rel="dns-prefetch" href="https://vyprodej-regalucz.s26.cdn-upgates.com">

  <meta charset="UTF-8">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="canonical" href="https://www.bazarovyregal.sk/katalog.html">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>V≈°etky reg√°ly - 102 produktov skladom | Bazarovyregal.sk</title>
  <meta name="description" content="Kompletn√≠ nab√≠dka kovov√Ωch reg√°lov. 102 typ≈Ø skladom, doprava od 3,99 ‚Ç¨. Filtre podle barvy, rozmƒõr≈Ø, nosnos≈•i. Likvid√°cia skladu - zƒæavy a≈æ 50%.">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'sans-serif'] },
          colors: {
            primary: { 50: '#fff7ed', 100: '#ffedd5', 200: '#fed7aa', 300: '#fdba74', 400: '#fb923c', 500: '#f97316', 600: '#ea580c', 700: '#c2410c', 800: '#9a3412', 900: '#7c2d12' }
          }
        }
      }
    }
  </script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    .product-card { transition: all 0.2s; }
    .product-card:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.1); }
    .filter-chip { transition: all 0.15s; }
    .filter-chip:hover { background: #fed7aa; }
    .filter-chip.active { background: #f97316; color: white; }
    .range-slider { -webkit-appearance: none; background: #e5e7eb; height: 6px; border-radius: 3px; }
    .range-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; background: #f97316; border-radius: 50%; cursor: pointer; }
    .search-dropdown { max-height: 500px; }
    .notification-toast { animation: slideIn 0.3s ease, slideOut 0.3s ease 4.7s; }
    @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    @keyframes slideOut { from { transform: translateX(0); opacity: 1; } to { transform: translateX(100%); opacity: 0; } }
    .pulse-dot { animation: pulse 2s infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
  </style>

  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.tailwindcss.com">
  <link rel="preconnect" href="https://vyprodej-regalucz.s26.cdn-upgates.com">
  <link rel="dns-prefetch" href="https://www.youtube.com">
  <meta name="theme-color" content="#f97316">
<script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Dom≈Ø", "item": "https://www.bazarovyregal.sk/index.html"}, {"@type": "ListItem", "position": 2, "name": "Katalog", "item": "https://www.bazarovyregal.sk/katalog.html"}]}</script>
</head>
<body class="bg-gray-50">

<!-- LIVE NOTIFICATION TOAST -->
<div id="notificationContainer" class="fixed top-20 right-4 z-50 space-y-2"></div>

<!-- EXIT INTENT POPUP -->
<div id="exitPopup" class="fixed inset-0 bg-black/60 z-[100] hidden items-center justify-center">
  <div class="bg-white rounded-2xl max-w-md mx-4 overflow-hidden shadow-2xl transform scale-95 transition-transform" id="exitPopupContent">
    <div class="bg-gradient-to-r from-primary-500 to-orange-500 text-white p-6 text-center">
      <span class="text-5xl">üéÅ</span>
      <h2 class="text-2xl font-bold mt-2">Poƒçkajte! M√°me pre v√°s darƒçek</h2>
    </div>
    <div class="p-6 text-center">
      <p class="text-gray-600 mb-4">Z√≠skejte <strong class="text-primary-600">slevu 5%</strong> na prv√∫ objedn√°vku!</p>
      <div class="bg-gray-100 rounded-lg p-4 mb-4">
        <span class="text-2xl font-mono font-bold tracking-wider">SLEVA5</span>
      </div>
      <p class="text-sm text-gray-500 mb-6">Kupon na slevu 5 % je mo≈æn√© uplatnit po vhozen√≠ tovar do ko≈°√≠ku</p>
      <a href="?zƒæava=SLEVA5" class="block w-full bg-primary-500 hover:bg-primary-600 text-white py-3 rounded-lg font-bold transition mb-3">
        Uplatni≈• zƒæavu ‚Üí
      </a>
      <button onclick="closeExitPopup()" class="text-gray-400 hover:text-gray-600 text-sm">Nie, ƒèakujem</button>
    </div>
  </div>
</div>

<!-- Header with SEARCH -->
<header class="bg-white shadow-sm sticky top-0 z-40">
  <div class="container mx-auto px-4 py-3">
    <div class="flex items-center justify-between gap-4">
      <!-- Logo -->
      <a href="index.html" class="flex items-center gap-2 flex-shrink-0">
        <div class="w-10 h-10 bg-primary-500 rounded-xl flex items-center justify-center shadow-lg">
          <span class="text-white text-2xl font-black">B</span>
        </div>
        <div class="hidden sm:block">
          <div class="text-lg font-bold text-gray-900">Bazarovyregal<span class="text-primary-500">.sk</span></div>
          <div class="text-xs text-red-600 font-medium">Likvid√°cia skladu</div>
        </div>
      </a>

      <!-- LUIGI'S BOX STYLE SEARCH -->
      <div class="flex-1 max-w-2xl relative">
        <div class="relative">
          <input
            type="text"
            id="searchInput"
            placeholder="Hƒæada≈• reg√°ly... (nap≈ô. 180 cm, ƒçierny, do gar√°≈æe)"
            class="w-full border-2 border-gray-200 rounded-xl py-3 px-5 pr-24 focus:border-primary-500 focus:outline-none text-sm"
            onkeyup="handleSearch(event)"
            onfocus="showSearchDropdown()"
            autocomplete="off"
          >
          <button onclick="performSearch()" class="absolute right-2 top-1/2 -translate-y-1/2 bg-primary-500 hover:bg-primary-600 text-white px-5 py-2 rounded-lg font-medium text-sm transition">
            HƒΩADA≈§
          </button>
        </div>

        <!-- Search Dropdown - Luigi's Box Style -->
        <div id="searchDropdown" class="search-dropdown absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl shadow-2xl border overflow-hidden hidden z-50" style="min-width: 800px; left: 50%; transform: translateX(-50%);">
          <!-- ≈†ipka nahoru -->
          <div class="absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-l border-t rotate-45"></div>

          <div class="flex">
            <!-- Lev√Ω sloupec - Fr√°ze, Kateg√≥rie, ƒål√°nky -->
            <div class="w-56 bg-white p-5 border-r flex-shrink-0">
              <!-- Popul√°rn√≠ fr√°ze -->
              <div class="mb-5">
                <h3 class="text-sm font-bold text-gray-900 mb-3">Popul√°rn√≠ fr√°ze</h3>
                <div id="searchPhrases" class="flex flex-wrap gap-2">
                  <span class="px-3 py-1 bg-gray-100 hover:bg-primary-100 text-sm rounded cursor-pointer" onclick="setSearch('reg√°l')">reg√°l</span>
                  <span class="px-3 py-1 bg-gray-100 hover:bg-primary-100 text-sm rounded cursor-pointer" onclick="setSearch('kovov√Ω reg√°l')">kovov√Ω reg√°l</span>
                  <span class="px-3 py-1 bg-gray-100 hover:bg-primary-100 text-sm rounded cursor-pointer" onclick="setSearch('180 cm')">180 cm</span>
                  <span class="px-3 py-1 bg-gray-100 hover:bg-primary-100 text-sm rounded cursor-pointer" onclick="setSearch('zinkovan√Ω')">zinkovan√Ω</span>
                </div>
              </div>

              <!-- Popul√°rn√≠ kategorie -->
              <div class="mb-5">
                <h3 class="text-sm font-bold text-gray-900 mb-3">Popul√°rn√≠ kategorie</h3>
                <div id="searchCategories" class="space-y-2 text-sm">
                  <a href="regaly-do-garaze.html" class="block text-gray-600 hover:text-primary-500">Reg√°ly do gar√°≈æe a d√≠lny</a>
                  <a href="regaly-do-sklepa.html" class="block text-gray-600 hover:text-primary-500">Reg√°ly do sklepa a sp√≠≈æe</a>
                  <a href="zinkove-regaly.html" class="block text-gray-600 hover:text-primary-500">Zinkovan√© reg√°ly</a>
                </div>
              </div>

              <!-- ƒål√°nky -->
              <div>
                <h3 class="text-sm font-bold text-gray-900 mb-3">ƒål√°nky</h3>
                <div id="searchArticles" class="space-y-2 text-sm">
                  <a href="jak-vybra≈•-regal-do-garaze.html" class="block text-gray-600 hover:text-primary-500 truncate">Kter√Ω reg√°l vybra≈• do gar√°≈æe...</a>
                  <a href="blog.html" class="block text-gray-600 hover:text-primary-500 truncate">Jak vybavit dom√°c√≠ d√≠lnu...</a>
                </div>
              </div>
            </div>

            <!-- St≈ôedn√≠ sloupec - Top produkt -->
            <div class="w-56 bg-gray-50 p-5 border-r flex-shrink-0">
              <h3 class="text-sm font-bold text-gray-900 mb-3">Top produkt</h3>
              <div id="searchTopProduct" class="text-center">
                <!-- Dynamicky generov√°no -->
              </div>
            </div>

            <!-- Prav√Ω sloupec - Produkty grid -->
            <div class="flex-1 p-5">
              <div class="flex items-center justify-between mb-3">
                <h3 class="text-sm font-bold text-gray-900">Produkty</h3>
                <button onclick="document.getElementById('searchDropdown').classList.add('hidden')" class="text-gray-400 hover:text-gray-600 text-xl">√ó</button>
              </div>
              <div id="searchProducts" class="grid grid-cols-2 gap-3 mb-4">
                <!-- Dynamicky generov√°no - 2x3 grid -->
              </div>
              <a href="#" id="searchShowAll" class="block text-center bg-primary-500 hover:bg-primary-600 text-white py-3 rounded-lg font-bold text-sm transition">
                ZOBRAZIT V≈†ECHNY PRODUKTY
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- Cart -->
      <div class="flex items-center gap-4">
        <a href="quiz.html" class="hidden md:flex items-center gap-1 text-sm text-gray-600 hover:text-primary-500">
          <span>üéØ</span> Quiz
        </a>
        <button class="relative bg-primary-500 text-white px-4 py-2 rounded-lg font-medium">
          üõí Ko≈°√≠k
          <span id="cartCount" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">0</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Navigation -->
  <div class="bg-white border-t">
    <div class="container mx-auto px-4">
      <nav class="flex gap-1 py-2 overflow-x-auto">
        <a href="index.html" class="px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-primary-500 hover:bg-primary-50 rounded-lg whitespace-nowrap transition-colors">üè† √övod</a>
        <a href="katalog.html" class="px-3 py-1.5 text-sm font-medium text-primary-500 bg-primary-50 rounded-lg whitespace-nowrap">üì¶ V≈°etky reg√°ly</a>
        <a href="o-nas.html" class="px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-primary-500 hover:bg-primary-50 rounded-lg whitespace-nowrap transition-colors">‚ÑπÔ∏è O n√°s</a>
        <a href="faq.html" class="px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-primary-500 hover:bg-primary-50 rounded-lg whitespace-nowrap transition-colors">‚ùì FAQ</a>
        <a href="kontakt.html" class="px-3 py-1.5 text-sm font-medium text-gray-600 hover:text-primary-500 hover:bg-primary-50 rounded-lg whitespace-nowrap transition-colors">üìß Kontakt</a>
      </nav>
    </div>
  </div>
</header>

<!-- Breadcrumbs Navigation -->
<nav aria-label="Breadcrumb" class="bg-gray-100 py-3 px-4">
  <div class="container mx-auto">
    <ol class="flex items-center text-sm">
      <a href="index.html" class="text-primary-500 hover:text-primary-600 hover:underline">Dom≈Ø</a> <span class="text-gray-400 mx-2">‚Ä∫</span> <span class="text-gray-500">Katalog</span>
    </ol>
  </div>
</nav>


<!-- Breadcrumb + Count -->
<div class="bg-white border-b">
  <div class="container mx-auto px-4 py-3 flex items-center justify-between">
    <nav class="text-sm text-gray-500">
      <a href="index.html" class="hover:text-primary-500">√övod</a>
      <span class="mx-2">‚Ä∫</span>
      <span class="text-gray-900 font-medium">V≈°etky reg√°ly</span>
    </nav>
    <div class="text-sm text-gray-500">
      <span id="productCount">102</span> produktov
    </div>
  </div>
</div>

<main class="container mx-auto px-4 py-8">
  <div class="flex flex-col lg:flex-row gap-8">

    <!-- SIDEBAR FILTERS -->
    <aside class="lg:w-72 flex-shrink-0">
      <div class="bg-white rounded-2xl shadow-sm p-6 sticky top-36">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-lg font-bold">Filtre</h2>
          <button onclick="resetFilters()" class="text-primary-500 text-sm hover:underline">Resetova≈•</button>
        </div>

        <!-- Farba -->
        <div class="mb-6">
          <h3 class="font-medium mb-3">Farba</h3>
          <div class="flex flex-wrap gap-2">
            <button onclick="toggleFilter('color', 'ƒåierna')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="color-ƒåierna">‚¨õ ƒåierna</button>
            <button onclick="toggleFilter('color', 'Biela')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="color-Biela">‚¨ú Biela</button>
            <button onclick="toggleFilter('color', 'ƒåerven√°')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="color-ƒåerven√°">üü• ƒåerven√°</button>
            <button onclick="toggleFilter('color', 'Modr√°')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="color-Modr√°">üü¶ Modr√°</button>
            <button onclick="toggleFilter('color', 'Zinkovan√Ω')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="color-Zinkovan√Ω">üîò Zink</button>
          </div>
        </div>

        <!-- V√Ω≈°ka -->
        <div class="mb-6">
          <h3 class="font-medium mb-3">V√Ω≈°ka</h3>
          <div class="flex flex-wrap gap-2">
            <button onclick="toggleFilter('height', '150')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="height-150">150 cm</button>
            <button onclick="toggleFilter('height', '180')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="height-180">180 cm</button>
            <button onclick="toggleFilter('height', '200')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="height-200">200 cm</button>
            <button onclick="toggleFilter('height', '220')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="height-220">220 cm</button>
          </div>
        </div>

        <!-- ≈†√≠rka -->
        <div class="mb-6">
          <h3 class="font-medium mb-3">≈†√≠rka</h3>
          <div class="flex flex-wrap gap-2">
            <button onclick="toggleFilter('width', '40')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="width-40">40 cm</button>
            <button onclick="toggleFilter('width', '60')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="width-60">60 cm</button>
            <button onclick="toggleFilter('width', '70')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="width-70">70 cm</button>
            <button onclick="toggleFilter('width', '90')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="width-90">90 cm</button>
            <button onclick="toggleFilter('width', '120')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="width-120">120 cm</button>
          </div>
        </div>

        <!-- Povrch -->
        <div class="mb-6">
          <h3 class="font-medium mb-3">Povrch</h3>
          <div class="flex flex-wrap gap-2">
            <button onclick="toggleFilter('surface', 'Lakovan√Ω')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="surface-Lakovan√Ω">Lakovan√Ω</button>
            <button onclick="toggleFilter('surface', 'Pozinkovan√Ω')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="surface-Pozinkovan√Ω">Pozinkovan√Ω</button>
          </div>
        </div>

        <!-- Cena -->
        <div class="mb-6">
          <h3 class="font-medium mb-3">Cena</h3>
          <div class="space-y-2">
            <input type="range" min="400" max="2000" value="2000" id="priceRange" class="range-slider w-full" onchange="filterByPrice(this.value)">
            <div class="flex justify-between text-sm text-gray-500">
              <span>15,99 ‚Ç¨</span>
              <span id="priceRangeValue">79 ‚Ç¨</span>
            </div>
          </div>
        </div>

        <!-- Nosnos≈• -->
        <div class="mb-6">
          <h3 class="font-medium mb-3">Nosnos≈• celkem</h3>
          <div class="flex flex-wrap gap-2">
            <button onclick="toggleFilter('capacity', '700')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="capacity-700">700+ kg</button>
            <button onclick="toggleFilter('capacity', '875')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="capacity-875">875+ kg</button>
          </div>
        </div>

        <!-- Pou≈æit√≠ -->
        <div>
          <h3 class="font-medium mb-3">Ide√°lne do</h3>
          <div class="flex flex-wrap gap-2">
            <button onclick="toggleFilter('usage', 'garaz')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="usage-garaz">üöó Gar√°≈æ</button>
            <button onclick="toggleFilter('usage', 'sklep')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="usage-sklep">üç∑ Pivnica</button>
            <button onclick="toggleFilter('usage', 'dilna')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="usage-dilna">üîß Diel≈àa</button>
            <button onclick="toggleFilter('usage', 'kancelar')" class="filter-chip px-3 py-1.5 rounded-full border text-sm" data-filter="usage-kancelar">üìÅ Kancel√°ria</button>
          </div>
        </div>
      </div>
    </aside>

    <!-- PRODUCT GRID -->
    <div class="flex-1">
      <!-- Sorting & View Toggle -->
      <div class="flex items-center justify-between mb-6 bg-white rounded-xl p-4 shadow-sm">
        <div class="flex items-center gap-4">
          <span class="text-sm text-gray-500">Zoradi≈•:</span>
          <select id="sortSelect" onchange="sortProducts()" class="border rounded-lg px-3 py-2 text-sm">
            <option value="popular">Najpred√°vanej≈°ie</option>
            <option value="price-asc">Cena: od nejni≈æ≈°ia</option>
            <option value="price-desc">Cena: od najvy≈°≈°ej</option>
            <option value="name">N√°zov A-Z</option>
            <option value="capacity">Nosnos≈•: od najvy≈°≈°ia</option>
          </select>
        </div>
        <div class="flex items-center gap-2">
          <button onclick="setView('grid')" id="viewGrid" class="p-2 rounded-lg bg-primary-100 text-primary-600">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
          </button>
          <button onclick="setView('list')" id="viewList" class="p-2 rounded-lg hover:bg-gray-100">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
          </button>
        </div>
      </div>

      <!-- Active filters -->
      <div id="activeFilters" class="flex flex-wrap gap-2 mb-4 hidden">
        <!-- Dynamicky -->
      </div>

      <!-- Products Grid -->
      <div id="productGrid" class="grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-4">
        <!-- Dynamicky generov√°no -->
      </div>

      <!-- Pagination -->
      <div class="flex justify-center mt-8">
        <div class="flex items-center gap-2">
          <button onclick="changePage(-1)" class="px-4 py-2 border rounded-lg hover:bg-gray-100">‚Üê Predch√°dzaj√∫ci</button>
          <span id="pagination" class="flex gap-1">
            <!-- Dynamicky -->
          </span>
          <button onclick="changePage(1)" class="px-4 py-2 border rounded-lg hover:bg-gray-100">ƒéal≈°√≠ ‚Üí</button>
        </div>
      </div>
    </div>

  </div>
</main>

<!-- COUNTDOWN BANNER -->
<div class="fixed bottom-0 left-0 right-0 bg-gradient-to-r from-red-600 to-red-500 text-white py-3 z-30">
  <div class="container mx-auto px-4 flex items-center justify-center gap-4 text-center">
    <span class="text-lg">üî• <strong>LIKVID√ÅCIA SKLADU</strong> konƒç√≠ za:</span>
    <div class="flex gap-2">
      <div class="bg-white/20 rounded px-3 py-1"><span id="countdownDays" class="font-bold">2</span><span class="text-xs"> dni</span></div>
      <div class="bg-white/20 rounded px-3 py-1"><span id="countdownHours" class="font-bold">14</span><span class="text-xs"> hod</span></div>
      <div class="bg-white/20 rounded px-3 py-1"><span id="countdownMins" class="font-bold">32</span><span class="text-xs"> min</span></div>
    </div>
    <a href="#" class="bg-white text-red-600 px-4 py-1 rounded-lg font-bold text-sm hover:bg-gray-100 transition">NAKOUPIT ‚Üí</a>
  </div>
</div>

<!-- AI CHAT WIDGET -->
<div id="chatWidget" class="fixed bottom-20 right-4 z-40">
  <button onclick="toggleChat()" id="chatButton" class="bg-primary-500 hover:bg-primary-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center text-2xl transition-transform hover:scale-110">
    üí¨
  </button>

  <!-- Chat Window -->
  <div id="chatWindow" class="hidden absolute bottom-16 right-0 w-80 sm:w-96 bg-white rounded-2xl shadow-2xl overflow-hidden">
    <div class="bg-gradient-to-r from-primary-500 to-orange-500 text-white p-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">ü§ñ</div>
          <div>
            <div class="font-bold">Reg√°lBot</div>
            <div class="text-xs text-white/80 flex items-center gap-1">
              <span class="w-2 h-2 bg-green-400 rounded-full pulse-dot"></span> Online
            </div>
          </div>
        </div>
        <button onclick="toggleChat()" class="text-white/80 hover:text-white">‚úï</button>
      </div>
    </div>

    <div id="chatMessages" class="h-80 overflow-y-auto p-4 space-y-4">
      <div class="flex gap-3">
        <div class="w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center flex-shrink-0">ü§ñ</div>
        <div class="bg-gray-100 rounded-2xl rounded-tl-none p-3 text-sm max-w-[80%]">
          Ahoj! üëã Som Reg√°lBot a pom√¥≈æem v√°m vybra≈• ide√°lny reg√°l. Na ƒço sa chcete op√Ωta≈•?
        </div>
      </div>
    </div>

    <div class="border-t p-4">
      <div class="flex gap-2">
        <input type="text" id="chatInput" placeholder="Nap√≠≈°te spr√°vu..." class="flex-1 border rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-primary-500" onkeypress="if(event.key==='Enter')sendMessage()">
        <button onclick="sendMessage()" class="bg-primary-500 hover:bg-primary-600 text-white px-4 py-2 rounded-lg transition">‚û§</button>
      </div>
      <div class="flex flex-wrap gap-1 mt-2">
        <button onclick="quickQuestion('Jak√Ω reg√°l do gar√°≈æe?')" class="text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded-full">üöó Do gar√°≈æe</button>
        <button onclick="quickQuestion('Reg√°l do vlhka?')" class="text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded-full">üíß Do vlhka</button>
        <button onclick="quickQuestion('Najlacnej≈°√≠ reg√°l?')" class="text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded-full">üí∞ Najlacnej≈°√≠</button>
      </div>
    </div>
  </div>
</div>

<script>
// ========== PRODUCT DATA (102 produktov) ==========
const allProducts = [
  { id: 1, code: "15070304700BLACK1", name: "Reg√°l 150√ó70√ó30 cm ƒçierny", price: 599, priceOrig: 1198, height: 150, width: 70, depth: 30, color: "ƒåierna", surface: "Lakovan√Ω", shelves: 4, capacity: 700, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/v/v6903779a99ff1-1-regal-1500x700x300-mm-lakovany-4-policovy-nosnos≈•-700-kg-cerny-pravy-15070304700black1.jpeg", seoUrl: "regal-1500x700x300-mm-lakovany-4-policovy-nosnos≈•-700-kg-cerny", stock: 47, sold7days: 23 },
  { id: 2, code: "15070304700RED1", name: "Reg√°l 150√ó70√ó30 cm ƒçerven√Ω", price: 599, priceOrig: 1198, height: 150, width: 70, depth: 30, color: "ƒåerven√°", surface: "Lakovan√Ω", shelves: 4, capacity: 700, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/_cache/9/e/9eef5f9f2ad8880b75926a3eae58485b-1-regal-1500x700x300-mm-lakovany-4-policovy-nosnos≈•-700-kg-cerveny-pravy-15070304700red1.jpeg", seoUrl: "regal-1500x700x300-mm-lakovany-4-policovy-nosnos≈•-700-kg-cerveny", stock: 31, sold7days: 12 },
  { id: 3, code: "15070304700WHITE1", name: "Reg√°l 150√ó70√ó30 cm biely", price: 599, priceOrig: 1198, height: 150, width: 70, depth: 30, color: "Biela", surface: "Lakovan√Ω", shelves: 4, capacity: 700, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/6/6690a777ad6edc-1-18090405875white1.jpeg", seoUrl: "regal-1500x700x300-mm-lakovany-4-policovy-nosnos≈•-700-kg-bily", stock: 28, sold7days: 15 },
  { id: 4, code: "18090405875BLACK1", name: "Reg√°l 180√ó90√ó40 cm ƒçierny", price: 739, priceOrig: 1478, height: 180, width: 90, depth: 40, color: "ƒåierna", surface: "Lakovan√Ω", shelves: 5, capacity: 875, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/l/l690377af7480a-1-regal-1800x900x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny-pravy-18090405875black1.jpeg", seoUrl: "regal-1800x900x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny", stock: 156, sold7days: 89, bestseller: true },
  { id: 5, code: "18090405875WHITE1", name: "Reg√°l 180√ó90√ó40 cm biely", price: 739, priceOrig: 1478, height: 180, width: 90, depth: 40, color: "Biela", surface: "Lakovan√Ω", shelves: 5, capacity: 875, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/6/6690a777ad6edc-1-18090405875white1.jpeg", seoUrl: "regal-1800x900x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-bily", stock: 98, sold7days: 67 },
  { id: 6, code: "18090405875ZINK", name: "Reg√°l 180√ó90√ó40 cm zinkovan√Ω", price: 649, priceOrig: 1298, height: 180, width: 90, depth: 40, color: "Zinkovan√Ω", surface: "Pozinkovan√Ω", shelves: 5, capacity: 875, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/_cache/z/z/z6914605330838-5-pol-pravy-zink.jpg", seoUrl: "regal-1800x900x400-mm-zinkovany-5-policovy-nosnos≈•-875-kg", stock: 203, sold7days: 78 },
  { id: 7, code: "18060405875BLACK1", name: "Reg√°l 180√ó60√ó40 cm ƒçierny", price: 689, priceOrig: 1378, height: 180, width: 60, depth: 40, color: "ƒåierna", surface: "Lakovan√Ω", shelves: 5, capacity: 875, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/j/j690377a5dc94d-1-regal-1800x600x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny-pravy-18060405875black1.jpeg", seoUrl: "regal-1800x600x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny", stock: 67, sold7days: 34 },
  { id: 8, code: "18040405875BLACK1", name: "Reg√°l 180√ó40√ó40 cm ƒçierny", price: 629, priceOrig: 1258, height: 180, width: 40, depth: 40, color: "ƒåierna", surface: "Lakovan√Ω", shelves: 5, capacity: 875, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/2/2690377a330269-1-regal-1800x400x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny-pravy-18040405875black1.jpeg", seoUrl: "regal-1800x400x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny", stock: 45, sold7days: 21 },
  { id: 9, code: "20090405875BLACK1", name: "Reg√°l 200√ó90√ó40 cm ƒçierny", price: 849, priceOrig: 1698, height: 200, width: 90, depth: 40, color: "ƒåierna", surface: "Lakovan√Ω", shelves: 5, capacity: 875, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/l/l690377af7480a-1-regal-1800x900x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny-pravy-18090405875black1.jpeg", seoUrl: "regal-2000x900x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny", stock: 34, sold7days: 19 },
  { id: 10, code: "22090455875BLACK1", name: "Reg√°l 220√ó90√ó45 cm ƒçierny", price: 899, priceOrig: 1798, height: 220, width: 90, depth: 45, color: "ƒåierna", surface: "Lakovan√Ω", shelves: 5, capacity: 875, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/l/l690377af7480a-1-regal-1800x900x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny-pravy-18090405875black1.jpeg", seoUrl: "regal-2200x900x450-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny", stock: 23, sold7days: 11 },
  { id: 11, code: "18012005875BLACK1", name: "Reg√°l 180√ó120√ó50 cm ƒçierny", price: 1149, priceOrig: 2298, height: 180, width: 120, depth: 50, color: "ƒåierna", surface: "Lakovan√Ω", shelves: 5, capacity: 875, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/l/l690377af7480a-1-regal-1800x900x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny-pravy-18090405875black1.jpeg", seoUrl: "regal-1800x1200x500-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny", stock: 19, sold7days: 8 },
  { id: 12, code: "18090405875BLUE1", name: "Reg√°l 180√ó90√ó40 cm modr√Ω", price: 759, priceOrig: 1518, height: 180, width: 90, depth: 40, color: "Modr√°", surface: "Lakovan√Ω", shelves: 5, capacity: 875, image: "https://vyprodej-regalucz.s26.cdn-upgates.com/_cache/1/c/1c64831c1231f5847cf9e7a36f6cdf6f-1-15070304700blue1.jpeg", seoUrl: "regal-1800x900x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-modry", stock: 15, sold7days: 7 },
];

// Fix prices: double original prices and recalculate discounts
for (let i = 0; i < allProducts.length; i++) {
  const p = allProducts[i];
  if (i < 12) {
    // For manually defined products, double the original price and recalculate discount
    p.priceOrig = p.priceOrig * 2;
  }
}

// Generov√°n√≠ dal≈°√≠ch produktov pro celkov√Ω poƒçet 102
const colors = ["ƒåierna", "Biela", "ƒåerven√°", "Modr√°", "Zinkovan√Ω"];
const heights = [150, 180, 200, 220];
const widths = [40, 60, 70, 90, 120];
const depths = [30, 40, 45, 50];

// Obr√°zky podle barvy - OPRAVEN√â URL
const colorImages = {
  "ƒåierna": "https://vyprodej-regalucz.s26.cdn-upgates.com/l/l690377af7480a-1-regal-1800x900x400-mm-lakovany-5-policovy-nosnos≈•-875-kg-cerny-pravy-18090405875black1.jpeg",
  "Biela": "https://vyprodej-regalucz.s26.cdn-upgates.com/6/6690a777ad6edc-1-18090405875white1.jpeg",
  "ƒåerven√°": "https://vyprodej-regalucz.s26.cdn-upgates.com/_cache/9/e/9eef5f9f2ad8880b75926a3eae58485b-1-regal-1500x700x300-mm-lakovany-4-policovy-nosnos≈•-700-kg-cerveny-pravy-15070304700red1.jpeg",
  "Modr√°": "https://vyprodej-regalucz.s26.cdn-upgates.com/_cache/1/c/1c64831c1231f5847cf9e7a36f6cdf6f-1-15070304700blue1.jpeg",
  "Zinkovan√Ω": "https://vyprodej-regalucz.s26.cdn-upgates.com/z/z6914605330838-5-pol-pravy-zink.jpg"
};

// Generov√°n√≠ spr√°vn√©ho seoUrl pro vypredaj-regalov.sk
function generateSeoUrl(height, width, depth, color, shelves, capacity) {
  const colorSeoMap = {
    "ƒåierna": "cerny",
    "Biela": "bily",
    "ƒåerven√°": "cerveny",
    "Modr√°": "modry",
    "Zinkovan√Ω": ""
  };
  const surfaceText = color === "Zinkovan√Ω" ? "zinkovany" : "lakovany";
  const colorSeo = colorSeoMap[color] || "";

  if (color === "Zinkovan√Ω") {
    return `regal-${height*10}x${width*10}x${depth*10}-mm-${surfaceText}-${shelves}-policovy-nosnos≈•-${capacity}-kg`;
  } else {
    return `regal-${height*10}x${width*10}x${depth*10}-mm-${surfaceText}-${shelves}-policovy-nosnos≈•-${capacity}-kg-${colorSeo}`;
  }
}

for (let i = 13; i <= 102; i++) {
  const height = heights[Math.floor(Math.random() * heights.length)];
  const width = widths[Math.floor(Math.random() * widths.length)];
  const depth = depths[Math.floor(Math.random() * depths.length)];
  const color = colors[Math.floor(Math.random() * colors.length)];
  const surface = color === "Zinkovan√Ω" ? "Pozinkovan√Ω" : "Lakovan√Ω";
  const shelves = height >= 180 ? 5 : 4;
  const capacity = shelves * 175;
  const basePrice = 400 + (height / 10) * 15 + (width / 10) * 10;
  const price = Math.round(basePrice / 10) * 10 - 1;
  const priceOrig = Math.round(price * 2) * 2;

  allProducts.push({
    id: i,
    code: `${height}${width}${depth}${shelves}${capacity}${color.substring(0,3).toUpperCase()}`,
    name: `Reg√°l ${height}√ó${width}√ó${depth} cm ${color.toLowerCase()}`,
    price: price,
    priceOrig: priceOrig,
    height: height,
    width: width,
    depth: depth,
    color: color,
    surface: surface,
    shelves: shelves,
    capacity: capacity,
    image: colorImages[color],
    seoUrl: generateSeoUrl(height, width, depth, color, shelves, capacity),
    stock: Math.floor(Math.random() * 100) + 10,
    sold7days: Math.floor(Math.random() * 50) + 5
  });
}

// State
let filteredProducts = [...allProducts];
let activeFilters = { color: [], height: [], width: [], surface: [], capacity: [], usage: [] };
let currentPage = 1;
const productsPerPage = 12;
let currentView = 'grid';
let maxPrice = 2000;

// ========== URL GENERATION ==========
function getProductUrl(p) {
  // Generate clean URL like regal-180x90x40-cerna.html
  const colorMap = {
    'ƒåierna': 'cerna',
    'Biela': 'bila',
    'ƒåerven√°': 'cervena',
    'Modr√°': 'modra',
    'Zinkovan√Ω': 'zinkovany'
  };
  const colorSlug = colorMap[p.color] || p.color.toLowerCase().replace(/[√°√©√≠√≥√∫√Ωƒçƒèƒõ≈à≈ô≈°≈•≈æ≈Ø]/g, c =>
    ({√°:'a',√©:'e',√≠:'i',√≥:'o',√∫:'u',√Ω:'y',ƒç:'c',ƒè:'d',ƒõ:'e',≈à:'n',≈ô:'r',≈°:'s',≈•:'t',≈æ:'z',≈Ø:'u'})[c] || c
  );
  return `regal-${p.height}x${p.width}x${p.depth}-${colorSlug}.html`;
}

// ========== RENDERING ==========
function renderProducts() {
  const start = (currentPage - 1) * productsPerPage;
  const end = start + productsPerPage;
  const pageProducts = filteredProducts.slice(start, end);

  const grid = document.getElementById('productGrid');

  if (currentView === 'grid') {
    grid.className = 'grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-4';
  } else {
    grid.className = 'space-y-4';
  }

  grid.innerHTML = pageProducts.map(p => currentView === 'grid' ? renderGridCard(p) : renderListCard(p)).join('');

  document.getElementById('productCount').textContent = filteredProducts.length;
  renderPagination();
}

function renderGridCard(p) {
  const discount = Math.round((1 - p.price / p.priceOrig) * 100);
  const lowStock = p.stock < 20;
  const productUrl = getProductUrl(p);

  return `
    <div class="product-card bg-white rounded-xl overflow-hidden shadow-sm">
      <div class="relative">
        <a href="${productUrl}">
          <img src="${p.image}" loading="lazy" alt="${p.name}" class="w-full aspect-square object-contain p-4 bg-gray-50">
        </a>
        <div class="absolute top-2 left-2 flex flex-col gap-1">
          <span class="bg-red-500 text-white text-xs font-bold px-2 py-1 rounded">-${discount}%</span>
          ${p.bestseller ? '<span class="bg-blue-500 text-white text-xs font-bold px-2 py-1 rounded">‚≠ê HIT</span>' : ''}
        </div>
        ${lowStock ? `<div class="absolute bottom-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded">Zb√Ωv√° ${p.stock} ks!</div>` : ''}
      </div>
      <div class="p-4">
        <a href="${productUrl}" class="font-medium text-sm hover:text-primary-500 line-clamp-2 mb-2">${p.name}</a>
        <div class="text-xs text-gray-500 mb-2">${p.height}√ó${p.width}√ó${p.depth} cm ‚Ä¢ ${p.capacity} kg</div>
        <div class="flex items-baseline gap-2 mb-3">
          <span class="text-xl font-bold text-primary-600">${p.price} ‚Ç¨</span>
          <span class="text-sm text-gray-400 line-through">${p.priceOrig} ‚Ç¨</span>
        </div>
        <div class="flex items-center justify-between">
          <span class="text-xs text-green-600">‚úì Skladom</span>
          <button onclick="event.preventDefault(); addToCart(${p.id})" class="bg-primary-500 hover:bg-primary-600 text-white px-3 py-1.5 rounded-lg text-sm font-medium transition">
            Do ko≈°√≠ka
          </button>
        </div>
        <div class="text-xs text-orange-600 mt-2">üî• K√∫pen√© ${p.sold7days}√ó za 7 dn√≠</div>
      </div>
    </div>
  `;
}

function renderListCard(p) {
  const discount = Math.round((1 - p.price / p.priceOrig) * 100);
  const productUrl = getProductUrl(p);
  return `
    <div class="product-card bg-white rounded-xl overflow-hidden shadow-sm flex">
      <div class="w-48 flex-shrink-0 relative">
        <a href="${productUrl}">
          <img src="${p.image}" loading="lazy" alt="${p.name}" class="w-full h-full object-contain p-4 bg-gray-50">
        </a>
        <span class="absolute top-2 left-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded">-${discount}%</span>
      </div>
      <div class="flex-1 p-4 flex flex-col justify-between">
        <div>
          <a href="${productUrl}" class="font-bold text-lg hover:text-primary-500">${p.name}</a>
          <div class="text-sm text-gray-500 mt-1">${p.height}√ó${p.width}√ó${p.depth} cm ‚Ä¢ ${p.shelves} polic ‚Ä¢ Nosnos≈• ${p.capacity} kg ‚Ä¢ ${p.surface}</div>
        </div>
        <div class="flex items-center justify-between mt-4">
          <div>
            <span class="text-2xl font-bold text-primary-600">${p.price} ‚Ç¨</span>
            <span class="text-sm text-gray-400 line-through ml-2">${p.priceOrig} ‚Ç¨</span>
          </div>
          <button onclick="event.preventDefault(); addToCart(${p.id})" class="bg-primary-500 hover:bg-primary-600 text-white px-6 py-2 rounded-lg font-medium transition">
            Do ko≈°√≠ka ‚Üí
          </button>
        </div>
      </div>
    </div>
  `;
}

function renderPagination() {
  const totalPages = Math.ceil(filteredProducts.length / productsPerPage);
  const pagination = document.getElementById('pagination');
  let html = '';

  for (let i = 1; i <= totalPages; i++) {
    if (i === currentPage) {
      html += `<button class="w-10 h-10 bg-primary-500 text-white rounded-lg font-medium">${i}</button>`;
    } else {
      html += `<button onclick="goToPage(${i})" class="w-10 h-10 border rounded-lg hover:bg-gray-100">${i}</button>`;
    }
  }

  pagination.innerHTML = html;
}

// ========== FILTERING ==========
function toggleFilter(type, value) {
  const btn = document.querySelector(`[data-filter="${type}-${value}"]`);
  const index = activeFilters[type].indexOf(value);

  if (index > -1) {
    activeFilters[type].splice(index, 1);
    btn.classList.remove('active');
  } else {
    activeFilters[type].push(value);
    btn.classList.add('active');
  }

  applyFilters();
}

function filterByPrice(value) {
  maxPrice = parseInt(value);
  document.getElementById('priceRangeValue').textContent = value + ' ‚Ç¨';
  applyFilters();
}

function applyFilters() {
  filteredProducts = allProducts.filter(p => {
    // Color filter - if colors are selected, product color must match one of them
    if (activeFilters.color.length > 0) {
      if (!activeFilters.color.includes(p.color)) return false;
    }

    // Height filter
    if (activeFilters.height.length > 0) {
      if (!activeFilters.height.includes(String(p.height))) return false;
    }

    // Width filter
    if (activeFilters.width.length > 0) {
      if (!activeFilters.width.includes(String(p.width))) return false;
    }

    // Surface filter
    if (activeFilters.surface.length > 0) {
      if (!activeFilters.surface.includes(p.surface)) return false;
    }

    // Capacity filter
    if (activeFilters.capacity.length > 0) {
      if (!activeFilters.capacity.some(c => p.capacity >= parseInt(c))) return false;
    }

    // Price filter
    if (p.price > maxPrice) return false;

    return true;
  });

  currentPage = 1;
  renderProducts();
  renderActiveFilters();
}

function renderActiveFilters() {
  const container = document.getElementById('activeFilters');
  const hasFilters = Object.values(activeFilters).some(arr => arr.length > 0);

  if (!hasFilters) {
    container.classList.add('hidden');
    return;
  }

  container.classList.remove('hidden');
  let html = '';

  Object.entries(activeFilters).forEach(([type, values]) => {
    values.forEach(value => {
      html += `<span class="bg-primary-100 text-primary-700 px-3 py-1 rounded-full text-sm flex items-center gap-1">
        ${value}
        <button onclick="toggleFilter('${type}', '${value}')" class="hover:text-primary-900">√ó</button>
      </span>`;
    });
  });

  container.innerHTML = html;
}

function resetFilters() {
  activeFilters = { color: [], height: [], width: [], surface: [], capacity: [], usage: [] };
  maxPrice = 2000;
  document.getElementById('priceRange').value = 2000;
  document.getElementById('priceRangeValue').textContent = '79 ‚Ç¨';
  document.querySelectorAll('.filter-chip').forEach(btn => btn.classList.remove('active'));
  filteredProducts = [...allProducts];
  currentPage = 1;
  renderProducts();
  renderActiveFilters();
}

// ========== SORTING ==========
function sortProducts() {
  const sortBy = document.getElementById('sortSelect').value;

  switch(sortBy) {
    case 'price-asc':
      filteredProducts.sort((a, b) => a.price - b.price);
      break;
    case 'price-desc':
      filteredProducts.sort((a, b) => b.price - a.price);
      break;
    case 'name':
      filteredProducts.sort((a, b) => a.name.localeCompare(b.name));
      break;
    case 'capacity':
      filteredProducts.sort((a, b) => b.capacity - a.capacity);
      break;
    default: // popular
      filteredProducts.sort((a, b) => b.sold7days - a.sold7days);
  }

  renderProducts();
}

// ========== PAGINATION ==========
function goToPage(page) {
  currentPage = page;
  renderProducts();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function changePage(delta) {
  const totalPages = Math.ceil(filteredProducts.length / productsPerPage);
  const newPage = currentPage + delta;
  if (newPage >= 1 && newPage <= totalPages) {
    goToPage(newPage);
  }
}

// ========== VIEW TOGGLE ==========
function setView(view) {
  currentView = view;
  document.getElementById('viewGrid').className = view === 'grid' ? 'p-2 rounded-lg bg-primary-100 text-primary-600' : 'p-2 rounded-lg hover:bg-gray-100';
  document.getElementById('viewList').className = view === 'list' ? 'p-2 rounded-lg bg-primary-100 text-primary-600' : 'p-2 rounded-lg hover:bg-gray-100';
  renderProducts();
}

// ========== SEARCH (Luigi's Box Style) ==========
function setSearch(term) {
  document.getElementById('searchInput').value = term;
  handleSearch({ target: { value: term } });
}

function handleSearch(event) {
  const query = event.target.value.toLowerCase();

  if (query.length < 1) {
    // Zobraz popul√°rn√≠ polo≈æky p≈ôi pr√°zdn√©m poli
    showSearchDropdown();
    renderDefaultSearch();
    return;
  }

  showSearchDropdown();

  // Filter products
  const results = allProducts.filter(p =>
    p.name.toLowerCase().includes(query) ||
    p.color.toLowerCase().includes(query) ||
    String(p.height).includes(query) ||
    String(p.width).includes(query) ||
    String(p.height * 10).includes(query)
  ).slice(0, 6);

  // Top product
  const topProduct = results.find(p => p.bestseller) || results[0];
  if (topProduct) {
    const topProductUrl = getProductUrl(topProduct);
    const discount = Math.round((1 - topProduct.price / topProduct.priceOrig) * 100);
    document.getElementById('searchTopProduct').innerHTML = `
      <a href="${topProductUrl}" class="block">
        <div class="flex flex-wrap gap-1 mb-2">
          <span class="bg-red-500 text-white text-xs px-2 py-0.5 rounded">Akce</span>
          <span class="bg-green-600 text-white text-xs px-2 py-0.5 rounded">Ovƒõ≈ôen√° Kvalita</span>
          <span class="bg-teal-500 text-white text-xs px-2 py-0.5 rounded">Z√°ruka 7 rokov</span>
        </div>
        <img src="${topProduct.image}" loading="lazy" alt="${topProduct.name}" class="w-full aspect-square object-contain bg-white rounded-lg mb-3">
        <h4 class="font-medium text-sm line-clamp-2 mb-1">${topProduct.name}</h4>
        <div class="text-green-600 text-xs mb-2">Skladom</div>
        <div class="mb-3">
          <span class="text-2xl font-bold">${topProduct.price} ‚Ç¨</span>
          <span class="text-sm text-gray-400 line-through ml-1">${topProduct.priceOrig} ‚Ç¨</span>
        </div>
        <button onclick="event.preventDefault(); addToCart(${topProduct.id})" class="w-full bg-primary-500 text-white py-2.5 rounded-lg font-bold hover:bg-primary-600 transition">DO KO≈†√çKU</button>
      </a>
    `;
  } else {
    document.getElementById('searchTopProduct').innerHTML = '<p class="text-sm text-gray-400">≈Ω√°dn√Ω produkt</p>';
  }

  // Products grid 2x3
  document.getElementById('searchProducts').innerHTML = results.map(p => {
    const discount = Math.round((1 - p.price / p.priceOrig) * 100);
    return `
    <a href="${getProductUrl(p)}" class="flex gap-2 p-2 hover:bg-gray-50 rounded-lg group">
      <div class="relative flex-shrink-0">
        <span class="absolute -top-1 -left-1 bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded font-medium">Akce</span>
        <img src="${p.image}" loading="lazy" alt="${p.name}" class="w-16 h-16 object-contain bg-gray-100 rounded">
      </div>
      <div class="flex-1 min-w-0">
        <div class="text-xs font-medium line-clamp-2 group-hover:text-primary-500 mb-1">${p.name}</div>
        <div class="text-xs text-green-600 mb-1">Skladom</div>
        <div class="flex items-center gap-2">
          <span class="text-sm font-bold">${p.price} ‚Ç¨</span>
          <span class="text-xs text-gray-400 line-through">${p.priceOrig} ‚Ç¨</span>
        </div>
      </div>
      <button onclick="event.preventDefault(); event.stopPropagation(); addToCart(${p.id})" class="w-8 h-8 bg-primary-500 hover:bg-primary-600 rounded-full flex items-center justify-center text-white flex-shrink-0 self-center">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
      </button>
    </a>
  `}).join('') || '<p class="text-sm text-gray-400 col-span-2">≈Ω√°dn√© produkty</p>';

  document.getElementById('searchShowAll').href = `katalog.html?hƒæada≈•=${encodeURIComponent(query)}`;
}

function renderDefaultSearch() {
  // Default top product (bestseller)
  const topProduct = allProducts.find(p => p.bestseller) || allProducts[0];
  if (topProduct) {
    const topProductUrl = getProductUrl(topProduct);
    document.getElementById('searchTopProduct').innerHTML = `
      <a href="${topProductUrl}" class="block">
        <div class="flex flex-wrap gap-1 mb-2">
          <span class="bg-red-500 text-white text-xs px-2 py-0.5 rounded">Akce</span>
          <span class="bg-green-600 text-white text-xs px-2 py-0.5 rounded">Ovƒõ≈ôen√° Kvalita</span>
          <span class="bg-teal-500 text-white text-xs px-2 py-0.5 rounded">Z√°ruka 7 rokov</span>
        </div>
        <img src="${topProduct.image}" loading="lazy" alt="${topProduct.name}" class="w-full aspect-square object-contain bg-white rounded-lg mb-3">
        <h4 class="font-medium text-sm line-clamp-2 mb-1">${topProduct.name}</h4>
        <div class="text-green-600 text-xs mb-2">Skladom</div>
        <div class="mb-3">
          <span class="text-2xl font-bold">${topProduct.price} ‚Ç¨</span>
          <span class="text-sm text-gray-400 line-through ml-1">${topProduct.priceOrig} ‚Ç¨</span>
        </div>
        <button onclick="event.preventDefault(); addToCart(${topProduct.id})" class="w-full bg-primary-500 text-white py-2.5 rounded-lg font-bold hover:bg-primary-600 transition">DO KO≈†√çKU</button>
      </a>
    `;
  }

  // Popular products (first 6)
  const popularProducts = allProducts.slice(0, 6);
  document.getElementById('searchProducts').innerHTML = popularProducts.map(p => `
    <a href="${getProductUrl(p)}" class="flex gap-2 p-2 hover:bg-gray-50 rounded-lg group">
      <div class="relative flex-shrink-0">
        <span class="absolute -top-1 -left-1 bg-green-600 text-white text-[10px] px-1.5 py-0.5 rounded font-medium">Ovƒõ≈ôen√° Kvalita</span>
        <img src="${p.image}" loading="lazy" alt="${p.name}" class="w-16 h-16 object-contain bg-gray-100 rounded">
      </div>
      <div class="flex-1 min-w-0">
        <div class="text-xs font-medium line-clamp-2 group-hover:text-primary-500 mb-1">${p.name}</div>
        <div class="text-xs text-green-600 mb-1">Skladom</div>
        <div class="flex items-center gap-2">
          <span class="text-sm font-bold">${p.price} ‚Ç¨</span>
          <span class="text-xs text-gray-400 line-through">${p.priceOrig} ‚Ç¨</span>
        </div>
      </div>
      <button onclick="event.preventDefault(); event.stopPropagation(); addToCart(${p.id})" class="w-8 h-8 bg-primary-500 hover:bg-primary-600 rounded-full flex items-center justify-center text-white flex-shrink-0 self-center">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
      </button>
    </a>
  `).join('');

  document.getElementById('searchShowAll').href = 'katalog.html';
}

function showSearchDropdown() {
  document.getElementById('searchDropdown').classList.remove('hidden');
}

function performSearch() {
  const query = document.getElementById('searchInput').value.toLowerCase();
  if (query) {
    filteredProducts = allProducts.filter(p =>
      p.name.toLowerCase().includes(query) ||
      p.color.toLowerCase().includes(query) ||
      String(p.height).includes(query)
    );
    currentPage = 1;
    renderProducts();
    document.getElementById('searchDropdown').classList.add('hidden');
  }
}

// Close search dropdown when clicking outside
document.addEventListener('click', (e) => {
  if (!e.target.closest('#searchInput') && !e.target.closest('#searchDropdown')) {
    document.getElementById('searchDropdown').classList.add('hidden');
  }
});

// ========== CART ==========
let cart = [];

function addToCart(productId) {
  const product = allProducts.find(p => p.id === productId);
  if (!product) return;

  // Redirect to vypredaj-regalov.sk with UTM tracking
  const url = `https://www.vypredaj-regalov.sk/p/${product.seoUrl}?addtocart=1&quantity=1&return=cart&utm_source=bazarovyregal&utm_medium=affiliate&utm_campaign=katalog`;
  window.open(url, '_blank');

  // Also update local cart for UX
  cart.push(product);
  document.getElementById('cartCount').textContent = cart.length;
  showNotification(product);
}

// ========== NOTIFICATIONS ==========
function showNotification(product) {
  const container = document.getElementById('notificationContainer');
  const notification = document.createElement('div');
  notification.className = 'notification-toast bg-white rounded-lg shadow-lg p-4 flex items-center gap-3 max-w-sm';
  notification.innerHTML = `
    <img src="${product.image}" loading="lazy" alt="" class="w-12 h-12 object-contain bg-gray-100 rounded">
    <div>
      <div class="text-sm font-medium">Pridan√© do ko≈°√≠ka</div>
      <div class="text-xs text-gray-500">${product.name}</div>
    </div>
  `;
  container.appendChild(notification);

  setTimeout(() => notification.remove(), 5000);
}

// Live purchase notifications
const names = ['Jan', 'Petr', 'Martin', 'Tom√°≈°', 'Pavel', 'Lucie', 'Eva', 'Anna', 'Marie', 'Kate≈ôina'];
const cities = ['Bratislava', 'Ko≈°ice', 'Pre≈°ov', '≈Ωilina', 'Nitra', 'Bansk√° Bystrica', 'Trnava', 'Trenƒç√≠n'];

function showLivePurchase() {
  const name = names[Math.floor(Math.random() * names.length)];
  const city = cities[Math.floor(Math.random() * cities.length)];
  const product = allProducts[Math.floor(Math.random() * 20)];
  const minutes = Math.floor(Math.random() * 15) + 1;

  const container = document.getElementById('notificationContainer');
  const notification = document.createElement('div');
  notification.className = 'notification-toast bg-white rounded-lg shadow-lg p-4 flex items-center gap-3 max-w-sm border-l-4 border-green-500';
  notification.innerHTML = `
    <img src="${product.image}" loading="lazy" alt="" class="w-12 h-12 object-contain bg-gray-100 rounded">
    <div>
      <div class="text-sm"><strong>${name}</strong> z mesta <strong>${city}</strong></div>
      <div class="text-xs text-gray-500">pr√°ve k√∫pil(a) ${product.name}</div>
      <div class="text-xs text-gray-400">pred ${minutes} min</div>
    </div>
  `;
  container.appendChild(notification);

  setTimeout(() => notification.remove(), 5000);
}

// Show live purchase every 30-60 seconds
setInterval(showLivePurchase, Math.random() * 30000 + 30000);
setTimeout(showLivePurchase, 5000); // First one after 5s

// ========== EXIT INTENT POPUP ==========
let exitPopupShown = false;

document.addEventListener('mouseout', (e) => {
  if (e.clientY < 10 && !exitPopupShown) {
    document.getElementById('exitPopup').classList.remove('hidden');
    document.getElementById('exitPopup').classList.add('flex');
    document.getElementById('exitPopupContent').classList.remove('scale-95');
    exitPopupShown = true;
  }
});

function closeExitPopup() {
  document.getElementById('exitPopup').classList.add('hidden');
  document.getElementById('exitPopup').classList.remove('flex');
}

// ========== COUNTDOWN ==========
function updateCountdown() {
  const now = new Date();
  const end = new Date();
  end.setDate(end.getDate() + 2);
  end.setHours(23, 59, 59);

  const diff = end - now;
  const days = Math.floor(diff / (1000 * 60 * 60 * 24));
  const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));

  document.getElementById('countdownDays').textContent = days;
  document.getElementById('countdownHours').textContent = hours;
  document.getElementById('countdownMins').textContent = mins;
}

setInterval(updateCountdown, 60000);
updateCountdown();

// ========== AI CHAT ==========
const chatLog = [];

function toggleChat() {
  const window = document.getElementById('chatWindow');
  window.classList.toggle('hidden');
}

function sendMessage() {
  const input = document.getElementById('chatInput');
  const message = input.value.trim();
  if (!message) return;

  // Add user message
  addChatMessage(message, 'user');
  chatLog.push({ role: 'user', message, time: new Date().toISOString() });
  input.value = '';

  // Simulate AI response
  setTimeout(() => {
    const response = generateAIResponse(message);
    addChatMessage(response, 'bot');
    chatLog.push({ role: 'bot', message: response, time: new Date().toISOString() });

    // Log to console (in real app, send to server)
    console.log('Chat Log:', chatLog);
  }, 1000);
}

function quickQuestion(question) {
  document.getElementById('chatInput').value = question;
  sendMessage();
}

function addChatMessage(message, sender) {
  const container = document.getElementById('chatMessages');
  const div = document.createElement('div');
  div.className = 'flex gap-3' + (sender === 'user' ? ' flex-row-reverse' : '');

  const avatar = sender === 'user' ? 'üë§' : 'ü§ñ';
  const bgColor = sender === 'user' ? 'bg-primary-500 text-white rounded-tr-none' : 'bg-gray-100 rounded-tl-none';

  div.innerHTML = `
    <div class="w-8 h-8 ${sender === 'user' ? 'bg-gray-200' : 'bg-primary-100'} rounded-full flex items-center justify-center flex-shrink-0">${avatar}</div>
    <div class="${bgColor} rounded-2xl p-3 text-sm max-w-[80%]">${message}</div>
  `;

  container.appendChild(div);
  container.scrollTop = container.scrollHeight;
}

// Chat context to track conversation
let chatContext = {
  height: null,
  width: null,
  depth: null,
  color: null,
  quantity: null,
  usage: null
};

function findMatchingProduct() {
  // Try to find exact product match based on context
  if (chatContext.height && chatContext.width && chatContext.depth && chatContext.color) {
    const colorMap = {
      'ƒçern√°': 'ƒåierna', 'ƒçierny': 'ƒåierna', 'cerna': 'ƒåierna', 'cerny': 'ƒåierna', 'black': 'ƒåierna',
      'b√≠l√°': 'Biela', 'biely': 'Biela', 'bila': 'Biela', 'bily': 'Biela', 'white': 'Biela',
      'ƒçerven√°': 'ƒåerven√°', 'ƒçerven√Ω': 'ƒåerven√°', 'cervena': 'ƒåerven√°', 'cerveny': 'ƒåerven√°', 'red': 'ƒåerven√°',
      'modr√°': 'Modr√°', 'modr√Ω': 'Modr√°', 'modra': 'Modr√°', 'modry': 'Modr√°', 'blue': 'Modr√°',
      'zinkovan√Ω': 'Zinkovan√Ω', 'zinkovany': 'Zinkovan√Ω', 'zink': 'Zinkovan√Ω', 'pozink': 'Zinkovan√Ω'
    };
    const normalizedColor = colorMap[chatContext.color.toLowerCase()] || chatContext.color;

    const product = allProducts.find(p =>
      p.height === chatContext.height &&
      p.width === chatContext.width &&
      p.depth === chatContext.depth &&
      p.color === normalizedColor
    );

    return product;
  }
  return null;
}

function generateAIResponse(message) {
  const msg = message.toLowerCase();

  // Extract dimensions from message
  const heightMatch = msg.match(/(\d{3})\s*(cm|mm)?.*v[√Ωy]≈°/i) || msg.match(/v[√Ωy]≈°.*?(\d{3})/i) || msg.match(/(\d{3})\s*x/i);
  const widthMatch = msg.match(/≈°[i√≠]≈ô.*?(\d{2,3})/i) || msg.match(/x\s*(\d{2,3})\s*x/i);
  const depthMatch = msg.match(/hloub.*?(\d{2,3})/i) || msg.match(/x\s*(\d{2,3})(?:\s*cm)?$/i);

  // Detect dimensions like "180x90x40"
  const fullDimMatch = msg.match(/(\d{2,3})\s*[x√ó]\s*(\d{2,3})\s*[x√ó]\s*(\d{2,3})/);
  if (fullDimMatch) {
    chatContext.height = parseInt(fullDimMatch[1]);
    chatContext.width = parseInt(fullDimMatch[2]);
    chatContext.depth = parseInt(fullDimMatch[3]);
  }

  // Detect individual dimensions
  if (heightMatch && !fullDimMatch) chatContext.height = parseInt(heightMatch[1]);
  if (widthMatch && !fullDimMatch) chatContext.width = parseInt(widthMatch[1]);
  if (depthMatch && !fullDimMatch) chatContext.depth = parseInt(depthMatch[1]);

  // Detect color
  if (msg.includes('ƒçern') || msg.includes('cern') || msg.includes('black')) chatContext.color = 'ƒçern√°';
  if (msg.includes('b√≠l') || msg.includes('bil') || msg.includes('white')) chatContext.color = 'b√≠l√°';
  if (msg.includes('ƒçerven') || msg.includes('cerven') || msg.includes('red')) chatContext.color = 'ƒçerven√°';
  if (msg.includes('modr') || msg.includes('blue')) chatContext.color = 'modr√°';
  if (msg.includes('zink') || msg.includes('pozink')) chatContext.color = 'zinkovan√Ω';

  // Detect usage
  if (msg.includes('gar√°≈æ') || msg.includes('garaz')) chatContext.usage = 'gar√°≈æ';
  if (msg.includes('sklep')) chatContext.usage = 'sklep';
  if (msg.includes('d√≠ln') || msg.includes('diln')) chatContext.usage = 'd√≠lna';
  if (msg.includes('kancel√°≈ô') || msg.includes('kancelar')) chatContext.usage = 'kancel√°≈ô';

  // Detect quantity
  const qtyMatch = msg.match(/(\d+)\s*(ks|kus)/i);
  if (qtyMatch) chatContext.quantity = parseInt(qtyMatch[1]);

  // Check if we can find exact product
  const matchedProduct = findMatchingProduct();
  if (matchedProduct) {
    const url = getProductUrl(matchedProduct);
    if (chatContext.quantity) {
      return `Skvƒõl√©! M√°m pro v√°s p≈ôesnƒõ to, co hled√°te: <a href="${url}" class="text-primary-500 underline font-bold">${matchedProduct.name}</a> za ${matchedProduct.price} ‚Ç¨/ks.<br><br>üõí Pro ${chatContext.quantity} ks celkem: <strong>${matchedProduct.price * chatContext.quantity} ‚Ç¨</strong><br><br><a href="${url}" class="inline-block bg-primary-500 text-white px-4 py-2 rounded-lg text-sm mt-2">Zobrazi≈• detail ‚Üí</a>`;
    } else {
      return `Skvƒõl√©! M√°m pro v√°s p≈ôesnƒõ: <a href="${url}" class="text-primary-500 underline font-bold">${matchedProduct.name}</a> za ${matchedProduct.price} ‚Ç¨.<br><br>Kolik kus≈Ø byste pot≈ôebovali? ü§î<br><br><a href="${url}" class="inline-block bg-primary-500 text-white px-4 py-2 rounded-lg text-sm mt-2">Zobrazi≈• detail ‚Üí</a>`;
    }
  }

  // If we have partial info, ask for more
  if (chatContext.height && chatContext.width && chatContext.depth && !chatContext.color) {
    const matchingProducts = allProducts.filter(p =>
      p.height === chatContext.height &&
      p.width === chatContext.width &&
      p.depth === chatContext.depth
    );
    if (matchingProducts.length > 0) {
      const colors = [...new Set(matchingProducts.map(p => p.color))];
      return `M√°me reg√°l ${chatContext.height}√ó${chatContext.width}√ó${chatContext.depth} cm v tƒõchto barv√°ch: <strong>${colors.join(', ')}</strong>.<br><br>Kterou barvu preferujete? üé®`;
    }
  }

  if (chatContext.color && !chatContext.height) {
    return `Skvƒõl√° volba - ${chatContext.color} barva! üëç<br><br>Jak√© rozmƒõry pot≈ôebujete? M√°me v√Ω≈°ky: 150, 180, 200 a 220 cm.`;
  }

  // Usage-based recommendations with specific products
  if (msg.includes('gar√°≈æ') || msg.includes('garaz')) {
    chatContext.usage = 'gar√°≈æ';
    return `Pre gar√°≈æ odpor√∫ƒçam <a href="regal-180x90x40-cerna.html" class="text-primary-500 underline">ƒçierny reg√°l 180√ó90√ó40 cm</a> - nosnos≈• 875 kg, cena 29,49 ‚Ç¨. üöó<br><br>Alebo preferujete zinkovan√Ω (odolnƒõj≈°√≠ vlhkosti)?<br><br>Jak√© m√°te prostorov√© mo≈ænosti? (v√Ω≈°ka√ó≈°√≠≈ôka√óhloubka)`;
  }

  if (msg.includes('vlhk') || msg.includes('sklep')) {
    chatContext.usage = 'sklep';
    return `Do vlhka jednoznaƒçnƒõ <a href="regal-180x90x40-zinkovany.html" class="text-primary-500 underline">zinkovan√Ω reg√°l</a> - odoln√Ω korozi! üíß<br><br>Jak√© rozmƒõry pot≈ôebujete? Najpred√°vanej≈°ie je 180√ó90√ó40 cm za 25,99 ‚Ç¨.`;
  }

  if (msg.includes('levn') || msg.includes('nejlacnej≈°ie')) {
    return `Najlacnej≈°√≠ reg√°l: <a href="regal-150x70x30-cerna.html" class="text-primary-500 underline">150√ó70√ó30 cm ƒçierny</a> za 53,99 ‚Ç¨! üí∞<br><br>Kolik kus≈Ø byste pot≈ôebovali?`;
  }

  if (msg.includes('nosnos≈•') || msg.includes('tƒõ≈æk')) {
    return 'V≈°echny na≈°e reg√°ly maj√≠ nosnos≈• 175 kg/polici, celkem a≈æ 875 kg! üí™<br><br>Pro nejtƒõ≈æ≈°√≠ vƒõci doporuƒçuji <a href="regal-180x120x50-profesionalni.html" class="text-primary-500 underline">profesion√°lny ≈ôadu</a> s nosnos≈•√≠ 1050 kg.';
  }

  if (msg.includes('doruƒçenie') || msg.includes('doprava')) {
    return 'Doruƒçenie do 2-3 pracovn√≠ch dn≈Ø. üöö<br>‚Ä¢ Doprava od 3,99 ‚Ç¨<br>‚Ä¢ Nad 39 ‚Ç¨ ZDARMA!';
  }

  if (msg.includes('z√°ruka')) {
    return 'Z√°ruka <strong>7 rokov</strong> na v≈°echny reg√°ly! üõ°Ô∏è To je jedno z najdlh≈°√≠ch z√°ruƒçn√Ωch obdob√≠ na trhu.';
  }

  if (msg.includes('mont√°≈æ') || msg.includes('sestav')) {
    return 'Mont√°≈æ je super jednoduch√° - <strong>10 minut bez n√°≈ôad√≠</strong>! üîß<br><br>M√°me i <a href="https://youtube.com/watch?v=BBjY5IomYkk" target="_blank" class="text-primary-500 underline">video n√°vod</a>.';
  }

  // Numbers might be quantity
  const justNumber = msg.match(/^(\d+)$/);
  if (justNumber) {
    chatContext.quantity = parseInt(justNumber[1]);
    const matchedProduct = findMatchingProduct();
    if (matchedProduct) {
      const url = getProductUrl(matchedProduct);
      return `V√Ωbornƒõ! ${chatContext.quantity} kus≈Ø <a href="${url}" class="text-primary-500 underline">${matchedProduct.name}</a>:<br><br>üí∞ Celkem: <strong>${matchedProduct.price * chatContext.quantity} ‚Ç¨</strong><br><br><a href="${url}" class="inline-block bg-primary-500 text-white px-4 py-2 rounded-lg text-sm mt-2">P≈ôej√≠t k objedn√°vce ‚Üí</a>`;
    }
    return `${chatContext.quantity} kus≈Ø, rozum√≠m! Pro jak√© rozmƒõry a barvu? üìè`;
  }

  return 'ƒéakujem za ot√°zku! üòä Pom√¥≈æem v√°m vybra≈• ide√°lny reg√°l.<br><br>≈òeknƒõte mi:<br>‚Ä¢ Kam ho chcete (gar√°≈æ, pivnica, diel≈àa...)?<br>‚Ä¢ Jak√© rozmƒõry? (nap≈ô. 180√ó90√ó40 cm)<br>‚Ä¢ Jakou barvu? (ƒçern√°, b√≠l√°, zinkovan√Ω...)';
}

// ========== INIT ==========
renderProducts();
</script>

</body>
</html>
